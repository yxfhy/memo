# メモ

印刷物スキャン画像における最新欠陥検出技術

印刷物のスキャン画像から意図しないドットや線状のアーチファクトを検出するには、高速・高精度な物体検出手法が必要とされる。近年、深層学習を用いたYOLO系モデル、DETR系モデル、そして最近提案されたDiffusionDetなどの最先端手法が注目されている。それぞれ技術的背景や性能特性、産業導入事例は以下の通りである。

YOLO系モデルの進化と最新動向

YOLO（You Only Look Once）は2016年にRedmonらが提案した単一ステージ物体検出モデルで、従来の2段階検出器（Faster R-CNNなど）に比べリアルタイム処理に適している。図示のように、オリジナルYOLOからYOLOv2/3（2017–18年）、Alexey BochkovskiyによるYOLOv4（2020年）、Ultralytics社のYOLOv5（2020年）を経て、近年はYOLOv6（2022）、YOLOv7（2022）、YOLOv8（2023）などが登場している。最新のYOLOv8はアンカーフリー設計と使いやすいAPIを特徴とし、2025年にはYOLOv12が報告されるなど進化が続いている。YOLO-NAS（Deci AI社）やZero-shotモデルのYOLO-World（Tencent AI Lab）なども提案され、精度と速度のバランスを自動探索する手法やテキストプロンプトで検出可能なパラダイムが研究されている。

YOLO系は高速推論が強みで、軽量モデルでは実装実験上188fps（fps：1秒あたりフレーム）以上を達成した報告もある。たとえばYOLOv8n（ナノモデル）は約188fpsを示し、超高速環境でのリアルタイム検出に優れる。またYOLOv10（2024年）では、従来モデルよりもレイテンシを大幅に削減しつつCOCOベンチマークで競合するAPを維持しており、RT-DETRと比較して1.8倍高速・パラメータ2.8倍少などの性能を示したことが報告されている。一方、YOLOv8や9といった最新モデルはモデルサイズと精度を最適化しており、十分高速でありながら精度面でも高い性能を発揮する。表のように、YOLOv8nはYOLOv3-tinyよりも大幅に少ないパラメータ・FLOPsで同等以上のFPSを達成している。

モデル	パラメータ数 (M)	FLOPs (G)	FPS (GPU)

YOLOv3-tiny	12.1	24.9	179
YOLOv8n	3.1	8.7	188
DETR (原論文)	41.6	100.5	148


このように、YOLO系は高速推論と高精度を両立しやすく、現場のリアルタイム検出に広く使われている。商用では、UltralyticsのYOLOライブラリやRoboflowのプラットフォームなどに組み込まれ、産業カメラ上での欠陥検出にも応用されている。印刷業や製造業の品質検査では、PCB（プリント基板）や包装印刷などの欠陥検出にYOLOベース手法の採用例が多い。たとえば、PCB表面欠陥検出用にYOLOv5を改良した研究や、包装・パッケージ印刷における色むら・破損検出への適用が報告されている。

処理速度と精度のバランス: YOLOは高速性を重視する一方で、近年は精度改善にも注力されており、小物体検出や複雑背景下でも高い検出率を示す。YOLO-NASや後述のRT-DETRなど他手法との競争により、速度-精度トレードオフの改善が続いている。

少量データ・学習データ不足への対応: YOLO自体は大量データで訓練されることが多いが、産業分野ではラベル付きサンプルが少ない問題がある。これに対し、YOLOと生成モデルを組み合わせた手法（YOLO-SD）が提案されている。これは、Stable Diffusionなどで欠陥画像を人工生成してデータを増強し、YOLOv8モデルで検出精度を高める試みである。同論文では、CLIPやControlNetによる制御可能な画像生成を導入し、少数の実データから有効な検出モデルを得ることに成功している。このようにデータ拡張や半教師あり技術を組み合わせてYOLOを強化する研究も進んでおり、少量データ環境での適用可能性が高まっている。

DETR系モデルの発展と適用

DETR (Detection Transformer) は2020年にCarionらが提案したTransformerベースの物体検出法で、オブジェクト検出を直接集合予測として扱うことでNMS（非最大抑制）やアンカー設計といった人手設計を排除した点が特徴である。トランスフォーマーの全体的な相互作用により、グローバル文脈を活用して検出を行い、COCOベンチマークでFaster R-CNNと同等の精度を示した。DETR導入当初は学習の収束が遅い・マルチスケール対応が弱いといった課題があったが、Deformable DETR（Zhu et al., ICLR2021）がデフォーマブルアテンションにより収束速度と小物体検出精度を大幅に改善し、「DETR比で10×少ないエポック数で同等以上の性能」を達成した。具体的には、Deformable DETR はDETRに比べて小物体検出性能が向上しつつ高速な学習を可能にした。

さらに、最新のDINO（2022年発表、改善型ノイズ除去学習）ではResNet-50でCOCO val検出で51.3 AP（24エポック時）を達成し、従来最高のDN-DETR比で＋6.0 APの性能向上を示した。DINOはノイズ付与訓練やアンカー初期化など技術を組み合わせることで訓練効率を高め、大規模データでの事前学習（Objects365など）による性能スケーリングも報告されている。これらの研究によりDETR系モデルは精度で強化されつつある。

一方、DETR系は従来YOLOに比べて推論速度が課題だった。そこでReal-Time DETR (RT-DETR) のような変種が提案されている。例えばBaiduのRT-DETR-LモデルはT4 GPU上で53.0% APを達成しつつ114 FPSを実現し、YOLO並みのリアルタイム性能を達成した。さらにRT-DETRv2（2024年）はアーキテクチャ改善によりさらに精度・速度を向上させている。要約すると、RT-DETRは「DETRの高精度性を維持しつつ、複数レイヤーを削減することで速度面を改善した」モデルで、FPSをクロススケール調整なしに可変できる柔軟性も持つ。これにより、DETR系も高速処理要件を満たしつつ高精度を追求できるようになっている。

欠陥検出への適用事例: DETR系の応用研究も増えており、特に電子部品や製造業の検査に向けて改良版が提案されている。たとえばプリント基板（PCB）の微小欠陥検出向けに、DETRを軽量化したMDD-DETRが開発され、一般的なRT-DETRより2.0%高い99.3% mAPを達成しつつパラメータを32.3%削減した。この手法は小さなマウスバイト欠陥等を高精度で検出する目的で、特徴抽出ネットワークやハイ・ロ周波数特徴の融合機構を導入している。また、鉄道の車軸亀裂検出に改良RT-DETRを用いた事例や、ベアリング欠陥検出に特化した軽量「Bearing-DETR」が提案されるなど、産業用途での適用例が報告されている。これらから、DETR系は従来CNN検出器では見落としがちな背景情報を捉える強みを生かしつつ、現場での欠陥検出へ応用されていることが伺える。

速度と精度のバランス: DETRオリジナルは大きなモデルで演算量も多いが、RT-DETRのような軽量化・高速化により、実験的に200fps超えのモデルも生まれている。ただし、表の通りDETR（原典）はYOLOv8nより重くFPSも低い。しかしDeformableやDINO、RT-DETRの導入で学習効率・推論速度ともに改善し、速度・精度の両立が進んでいる。

少量データ・学習データ不足への対応: DETR系も大量データ前提の訓練が基本だが、最近は自己教師あり事前学習やマルチスケール強化により小データへの対応力を高める研究がある。また、ゼロショット検出の概念として TencentのYOLO-Worldに似たプロンプトベース検出も研究されており、これらを応用することで少ないラベルでも検出可能な手法につながる可能性がある。DETR自体のFew-shot検出研究は少ないが、たとえばDN-DETR では訓練時のノイズ除去学習により頑健性を増している。いずれにせよ、DETR派生モデルも大規模事前学習やデータ拡張で対応力を強化しつつある。

DiffusionDet（拡散モデルによる検出）の登場と特徴

DiffusionDet は2023年ICCVで提案された新手法で、画像生成で成功した拡散モデルの枠組みを物体検出に適用した初の試みである。従来の検出器はアンカーや学習クエリを用いるが、DiffusionDetは「ノイズの乗ったランダムなバウンディングボックスから段階的に正解のボックスへデノイズ（ノイズ除去）していく」仕組みを採用する。図のように、学習では真のボックスにガウスノイズを加えた複数段階のボックス列を生成し、モデルに逆拡散過程を学習させる。推論時にはランダムなボックス集合から開始し、検出ヘッドを繰り返し適用して位置を洗練していく。この方式により、検出すべきオブジェクト数を固定せずに変化させることができる動的ボックス数の扱いを得意とする。また、同じモデルパラメータで複数回推論を繰り返し（iterative evaluation）最終出力を得ることで性能をさらに向上できる柔軟性がある。

初期実験では、DiffusionDetは標準ベンチマークで既存検出器に匹敵する性能を示している。特に、COCO訓練済みモデルを未学習の人検出データ（CrowdHuman）にゼロショット適用したところ、1000個の初期ボックス×4ステップの場合、従来DETRより4.8–5.3AP高い結果となった。これは、拡散的なサンプリング過程が転移学習にも有効であることを示唆する。ただし、DiffusionDetは反復的な推論を必要とするため処理速度は従来手法より遅い傾向がある。現時点では産業用途での実装例は限られているが、任意ボックス数・繰り返し処理といった新機能は、欠陥件数が予測困難な製造検査などへの応用ポテンシャルを秘める。

その他主流モデル・アプローチ

印刷・製造業界で欠陥検出に用いられるモデルとしては、上記以外にも伝統的なCNN系検出器や異常検知手法が挙げられる。Faster R-CNNやMask R-CNNといった2段階検出器は、高い精度を得られる一方で処理速度で劣る。SSDやRetinaNetなど1段階検出器も検証されており、YOLO系と比較実験されることが多い。また、少量データ・アンラベルトデータの活用という観点では、自己教師あり学習や半教師あり学習の検出手法、あるいは異常検知手法（Autoencoder, GAN, パッチベース検出など）も研究されている。例えば、MVTec ADなどのアノマリーデータセットを対象に、Few-shotやZero-shotアプローチ、拡散モデルによる欠陥合成（DefectFill等）といった最新研究が進展中である。さらに、Vision Transformer（ViT）等の大規模事前学習モデルを基盤とした検出手法やCLIP類似の視覚言語モデルを利用した異常検知（YOLO-Worldに類するプロンプト検出）も注目されている。

ただし、300枚/分（＝5fps以上）という処理要件を考慮すると、現状ではYOLO系や最適化されたDETR系が有力候補となる。一方で高い精度重視で速度をやや犠牲にしてもよい場合は、DAutoEncoder型の異常検知や半教師ありセグメンテーション（Siameseネットワーク等）が検討される。少量データ対応では、データ拡張技術（合成データ生成）や自己教師学習を活用したモデルが多くの研究で効果を上げている。

まとめ

印刷物スキャン画像から線状・点状の欠陥をリアルタイム検出するには、「高速性」と「少量データでの汎用性」という相反する要件を両立する必要がある。YOLO系モデルは従来から高速検出で実績があり、YOLOv8/9/10など最新世代では精度面でも優れる。またYOLO-SDに代表されるように、欠陥画像の少数しか得られない現場においては生成モデルとの融合でデータ不足問題に対処するアプローチが有効である。一方、DETR系モデルは拡張的な設計で精度面に強く、特にDeformable DETRやDINOによって学習効率・精度が劇的に向上した。RT-DETRの登場によりリアルタイム性能も得ており、実運用に耐えうる水準に近づきつつある。DiffusionDetは新機軸であり、複数の初期ボックスから動的に検出できる利点があるものの実装例は少ない。

最終的には利用用途・環境に応じて選択されるべきである。印刷業界では、OCR・線幅検出など従来技術に加えこれら学習モデルを組み合わせることで、人手では見逃しがちな微小欠陥の高精度検出が可能となっている。各手法は進化が続いており、速度と精度の改善やデータ効率化技術が同時に進む中で、今後も最新技術の追跡が重要である。

参考資料: YOLOの発展、DETR系モデルの原理および後継研究、DiffusionDetの提案、産業応用例など。



作成日時: 2025-06-25 11:55:23