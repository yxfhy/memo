# 物体検出モデルの比較と評価

比較対象モデルの概要

YOLO系（例：YOLOv8）: 代表的な一段検出器で、軽量で高速な推論が特徴。異なるサイズ（Tiny～Large）が公開されており、NVidia A100上でYOLOv8mは約50.2% mAP（COCO）を達成。マルチスケール畳み込み＋アンカーなし設計で、産業用外観検査などに広く適用されている。

DETR系（例：RT-DETR／RTDETRv2）: トランスフォーマーに基づく終端検出器。最新のRT-DETRv2（ResNet50版）はCOCOで53.1% mAPを達成し、Nvidia T4で108 FPSの高速推論を実現する。従来のDETRに比べエンコーダー・クエリ処理を最適化し、NMS不要のエンドツーエンド検出を提供する。強力なグローバル・アテンションにより、密集・複雑なシーンでも高精度が得られる一方、モデル規模や計算量は大きくなる。

DiffusionDet: 拡散モデルを用いた検出フレームワーク（ICCV2023）。ノイズ付きボックスから対象を生成する生成的アプローチで、ResNet50版で45.8% AP（COCO）を記録し、SwineBase版では約52.3% APに達する。推論時はランダムボックスを段階的に洗練する必要があり、A100上で30 FPS程度と速度は抑えめ。DETRのように固定クエリを持たず、柔軟なボックス数や反復処理で精度調整が可能である。


1. 検出精度

YOLOv8: 上位モデル（v8l）は約52.9% mAP (COCO)。小型モデルでは精度は低下するが、最適化により実運用での物体検出精度は高い。近年では産業画像向けにYOLOv7/8系を基に詳細向上を図る手法が多数提案されており、溶接ビードや金属表面、トンネル欠陥など各種欠陥検出でYOLO系モデルの適用例が報告されている。ただし、微小欠陥や低コントラスト領域では誤検出や見逃しが問題となる場合がある。

DETR系（RT-DETRv2）: RT-DETRv2-R50で53.1% AP（COCO）と、YOLO系を上回る精度を示す。特にオブジェクトが密集する複雑シーンでの識別能力に優れる。ResNet101版ではさらに54.3%まで向上する。従来DETR（R50）は42.0%とやや低かったが、RT-DETRでは大幅改善している。

DiffusionDet: ResNet50版で45.8% AP（COCO）。これはFaster R-CNN (40.2%)や元DETR (42.0%)を上回り、Sparse R-CNN (45.0%)と同等以上の結果である。反復処理数やランダムボックス数を増やすとさらに精度向上し（例：4ステップで46.5%）。大規模バックボーン（Swin-base）では52％を超える高精度も報告されており、画像内の複雑な文脈を捉えやすい。


2. 推論速度（FPS/レイテンシ）

YOLO系: 速度の点で最速クラス。Ultralytics実装ではYOLOv8nでA100上0.99ms、YOLOv8mで1.83ms（順次速さはモデル小型化と等価）。つまり数百〜1000FPS級が理論上可能であり、実世界アプリでもリアルタイム性に優れる。例えば、YOLOv8mでTesla T4では約55 FPSとの報告がある。

DETR系（RT-DETR）: 従来DETR(R50)は約39 FPS（A100）だったが、RT-DETRでは大幅に高速化され、T4で108 FPS（R50版）を達成したと報告されている。デコーダ層数の調整により推論時間を柔軟に制御できるのも利点。速度面ではYOLO系よりはやや遅いものの、最新手法では実用レベルのリアルタイム性能を示す。

DiffusionDet: 推論は30〜31 FPS程度（ResNet50, A100, バッチ1）で、YOLO/RT-DETRに比べると低速である。段階的復元の反復回数を増やすと精度は上がるが速度は更に低下する。工夫すればSparse R-CNN並みの速度に近づくが、ミリ秒単位で処理可能なYOLOには及ばない。


3. モデルサイズ・軽量性

YOLO系: 各種モデルが存在し、小型モデルは数百万パラメータ（YOLOv8n 約3.2M）、大規模型でも数千万台（YOLOv8l 約43.7M）に収まる。特にTiny系やS/Mクラスは組込み用途にも適する。

DETR系: ResNet50版で約25M、ResNet101版で約42Mのパラメータと、YOLOv8l級の大きさ。大型バックボーンを用いればさらに増大する。

DiffusionDet: ResNet50版はDETR相当（約40Mオーダー）と思われるが、SwineBaseを用いるとパラメータは100M近くになる可能性がある（実装依存）。一般にDiffusionDetは複数ステップ推論で計算コストが高いため、軽量化が課題である。


4. 学習データ要件・アノテーションコスト

共通事項: いずれの手法も通常は教師あり学習で、各画像に対しバウンディングボックス＋クラスラベルを用意する必要がある。工業検査用途でのラベル付けはコスト高だが、YOLO/DETR/DiffusionDetいずれも同様の注釈を必要とする。既存検出器向けの大規模データセット(COCO等)や欠陥専用データセットを用いて学習し、その後対象ドメインに微調整を行うのが一般的である。弱教師あり手法は研究段階で、これら直接的比較手法には含まれない。


5. 汎化性能・ドメイン適応力

YOLO系: 既存データに対して高精度だが、ドメインシフト（光源や背景の違いなど）には弱い面も指摘される。追加のデータ拡張やドメイン一般化技術を併用することが多い。

DETR系（RT-DETR）: グローバル文脈を捉える仕組みのため、未学習環境への転移性能が比較的高い可能性が示唆されている。実際、ある研究ではRT-DETRが学習時と異なる国の道路シーン（ROAD-Almatyデータセット）で、YOLOv8sよりも顕著に高いF1スコア（0.672 vs 0.458）を示した。高IoU閾値でも安定した性能を維持する傾向があるという。

DiffusionDet: 柔軟なボックスセットと反復評価が可能なため、ゼロショット転移に強い性質が確認されている。例えば、COCOで学習したモデルをCrowdHumanデータに転用する際、評価時のボックス数やステップ数を増やすだけでAPが5%以上向上したとの結果が報告されている。これはモデル学習時にクエリを固定しないアプローチの利点である。


6. 実装・導入のしやすさ

YOLO系: Ultralytics などライブラリが充実しており、PyTorch/Pythonのインターフェースで簡単に利用可能（公式モデル、チュートリアル、ONNX/TensorRT変換も整備）。学習済みモデルやエクスポート機能も豊富。組み込み機器向けにも対応例が多い。

DETR系: Detectron2やTensorFlow Hubなどで実装例が増えている。RT-DETRv2もPyTorch版の公式実装が公開されている。ただし、トランスフォーマー部品の利用や学習スケジュールなど取り回しはやや複雑で、GPUメモリも多く必要になる場合がある。推論速度調整機能は優れているが、現状YOLOほど高速化のライブラリサポートは成熟していない面もある。

DiffusionDet: 著者によるPyTorch実装（GitHub公開）があるが、公式ライブラリは存在せず、ユーザーコミュニティはまだ小さい。利用する場合はコードを自前で組む必要がある。推論では反復計算がボトルネックとなるため、特別なハードウェア最適化が求められる。


7. 実運用・産業応用例

YOLO系: 多数の実例あり。例として、製造ラインでの包装欠陥検出システムや、金属表面・食品・電子部品など各種製品検査にYOLOv4/v5/v7/v8が適用されている（Ultralyticsも産業オートメーション用途を事例紹介）。企業・研究での導入事例が豊富で、リアルタイム検査用途として幅広く採用されている。

DETR系: 新しい技術であり、産業での実用例はまだ少ない。研究ではHPRT-DETRなど変種を用いた板金欠陥検出などが報告されているが、商用システムへの採用は限定的である。今後の研究でその実力が実証されれば拡大が期待される。

DiffusionDet: 非常に新しい手法なため、実運用例は現時点でほぼ存在しない。研究論文中でも標準ベンチマーク（COCO, CrowdHuman）での評価が主で、産業応用例は未報告である。


参考: 各モデルの公表値や論文・実装報告に基づき比較した。例えばYOLOv8（Ultralytics）はCOCOで37.3–52.9% mAP、RT-DETRv2は53.1% AP（ResNet50）、DiffusionDet（ResNet50）は45.8% APという性能実績が示されている。また、検出速度やメモリ効率、実装のしやすさについては各種公式ドキュメントや研究報告を参照して整理した。以上を踏まえ、実際の欠陥検出システムでは「処理速度重視か高精度重視か」「使用可能なハードウェア」「ドメイン固有性の強さ」「開発・運用コスト」といった要件に応じて、各手法のトレードオフを考慮して選択することになる。



作成日時: 2025-07-02 09:38:51