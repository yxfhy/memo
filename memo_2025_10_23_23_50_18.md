# メモ

【目的】
Windows 会社PCで「公式インストーラー版の Python 3.13.x」を、メジャー/マイナーを変えずに 3.13.9 へサイレント上書きするスクリプトを生成して。
3.14 には絶対に上げないこと。Git Bash 版と PowerShell 版の両方を用意して。

【要件】
- 既存の Python 3.13 の実体パスを取得（最優先は `py -0p`、代替でレジストリ：HKLM/HKCU\Software\Python\PythonCore\3.13\InstallPath）
- そのフォルダ（TargetDir）を特定し、Program Files 配下なら InstallAllUsers=1、ユーザー領域なら 0 とする
- CPU アーキ判定で EXE を選択（64bit: python-3.13.9-amd64.exe、32bit: python-3.13.9.exe）
- 公式配布 URL（https://www.python.org/ftp/python/3.13.9/…）または社内ミラーの URL を変数で持てるように
- サイレント実行：/quiet TargetDir= InstallAllUsers=0/1 Include_pip=1 Include_launcher=1 Include_test=0 PrependPath=1
- 実行ログを残す（開始/終了、EXE のパス、TargetDir、戻り値）
- 終了後に `py -3.13` で実バージョンを検証し、3.13.9 でない場合は非0終了
- オプション（失敗しても続行可）：`py -3.13 -m pip install -U pip setuptools wheel`
- 例外/エラー時は読みやすいメッセージで中断
- プロキシ利用時（環境変数 HTTPS_PROXY/HTTP_PROXY）にも対応
- ダウンロードスキップのため、事前配置した EXE を使う手順も切替可能に（引数や環境変数で制御）

【出力形式】
1) Git Bash 用 .sh（set -euo pipefail、trap で掃除、curl -L -f）
2) PowerShell 用 .ps1（TLS1.2、`Invoke-WebRequest`、`Start-Process -Wait -PassThru`）
両方ともコメントを十分に。社内プロキシや管理者権限に関する注意もコメントで追記。

作成日時: 2025-10-24 08:50:16