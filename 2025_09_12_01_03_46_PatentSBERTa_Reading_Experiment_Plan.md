# 特許空間探索のためのPatentSBERTa実践計画

ご主人さま、メイドのわたしが「PatentSBERTa を軸に特許空間で遊べる力」をつけるための読書＆実験プランをおまとめします。BERTの基礎はご存じとのことなので、Sentence-BERT→特許特化→適応学習→評価と可視化→応用設計、の順で進めます。

フェーズ0（半日）下地合わせ

SBERTの原典を流し読み：なぜ「双塔/三重塔＋コサイン」で高速類似になるか、損失とプーリングを確認。

実装の“作法”だけ把握：sentence-transformersのクイックスタートとトレーニング構成。

類似度と正規化の要点：正規化済みベクトルではdot=cosine、Normalize層の意味。


フェーズ1（1〜2日）Sentence-BERT系の今

SimCSE系：ドロップアウトをノイズにした単純な対比学習。特許ドメインへの応用可否を念頭に読む。

TSDAE（教師なしドメイン適応）：ラベル無しテキストだけでドメイン適応できる代表手法。

実装Tips：normalize_embeddings=Trueを使う場面、類似度関数の選択。


フェーズ2（2〜3日）特許特化モデルを比較理解

PatentSBERTa（主役）：特許請求項を中心にSBERTで埋め込み→KNN等に活用するハイブリッド枠組み。2021原著と2024拡張版（TFSC）を対で確認。

BERT for Patents（事前学習済み基盤）：Googleが1億件超の特許で事前学習したBERT LARGE。SBERTの背骨に据える候補。

PaECTER（2024）：BERT for Patentsを審査官付与の引用情報で微調整した文書レベルエンコーダ。類似タスクで既存より改善と報告。


フェーズ3（1〜2日）評価ベンチと指標の押さえ

一般ベンチ：BEIR（ゼロショットIR）とMTEB（巨大埋め込みベンチ）。“特許専用でなくとも評価設計の型”を見る目的で。

特許系データセットの当たり：Patent Phrase Similarity（Kaggle）／BIGPATENT（要約）などは補助的に把握。

指標：検索はnDCG/MAP/MRR、クラスタはNMI/ARI、STSはスピアマン。MTEBのタスク‐指標対応が参考。


フェーズ4（2〜3日）クラスタリング＆ラベル付けの実務

BERTopic：埋め込み→HDBSCAN等でクラスタ→c-TF-IDFでトピック語抽出という“説明可能”パイプライン。

キーワード抽出：KeyBERTやKeyLLMでクラス語彙を整えてラベルの質を底上げ。

時系列トレンド：BERTopicのTopics-over-Timeで技術潮流の遷移を見る。


フェーズ5（1〜2日）検索スタックの“今風”整理

二段構え：Bi-encoder（PatentSBERTa等）で高速候補→Cross-encoderリランカーで精密化（MS-MARCO系MiniLMやBGE-reranker）。

実務メモ：再ランクは高精度だが重い＝上位N件に限定、PatentSBERTaの正規化出力なら内積で高速。


フェーズ6（2〜4日）ミニ実験メニュー（社内データで再現可能）

1. 請求項だけvs要約/明細書：どのセクションがご主人さまのユースケース（近傍探索/クラス推定/距離地図）に効くか、SBERT系で比較。根拠：PatentSBERTaは請求項重視で有効例。


2. 教師なし適応：TSDAEで社内パテント文にドメイン適応→近傍精度とクラスタ純度を測る。


3. 検索→再ランク：PatentSBERTaでFAISS近傍取得→bge-rerankerで上位50を順位付け。ゼロショットでのnDCG改善量を見る。


4. トピック地図と“Patent Distance”：BERTopicのトピック中心間距離＋クラスタ内散らばりで距離指標の素案を作り、PaECTERやBERT for Patents埋め込みでも再計算して頑健性を見る。



補遺：ベクトルが“球っぽい”件

なぜ球面に乗るのか：SBERTは出力をNormalizeする設計が一般的で、長さ=1に揃うため“球”に張り付く。このときcosine≡dotになり最近傍探索が速い。

長さ情報は捨ててよいか：Sentence類似では方向が本質で、長さは語数等の影響を受けやすい。必要があれば非正規化モデル＋内積で“長さ”も含めた相似を試すのが折衷。


リーディングリスト（優先順）

1. Sentence-BERT 原著（2019） – アーキと速度の意義。


2. PatentSBERTa（arXiv 2021）＋拡張版（2024 TFSC） – 特許距離／KNN分類の核。


3. BERT for Patents（HFカード） – 1億件超の事前学習。


4. PaECTER（2024） – 引用情報で微調整した特許文書埋め込み。


5. SimCSE（2021）／TSDAE（2021） – ラベル無しでも質を上げる要。


6. BERTopic（2022）＋c-TF-IDF – 説明可能クラスタとラベル。


7. BEIR（2021）／MTEB（2022） – 評価の型を輸入。


8. 再ランク（MS-MARCO MiniLM／BGE） – 二段検索の定石。



ご主人さま、この順に読めば、PatentSBERTaを起点に“距離・検索・分類・地図化”まで一気通貫で設計できるはずです。



作成日時: 2025-09-12 10:03:39