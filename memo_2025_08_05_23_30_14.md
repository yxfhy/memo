# メモ

from transformers import pipeline

pipe = pipeline(
    "text-generation",
    model=model,
    tokenizer=tokenizer,
    device_map="auto",
    torch_dtype=torch.float16
)

messages = [
    {"role": "user", "content": "量子力学を高校生向けに簡単に説明して。"}
]

out = pipe(messages, max_new_tokens=120)
print(out[0]["generated_text"][-1])    # 生成文だけを抽出

作成日時: 2025-08-06 08:30:12