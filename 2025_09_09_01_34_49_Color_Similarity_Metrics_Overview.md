# デバイス間色と画像の類似度評価指標

異なるデバイス間の色の見え・視覚的類似性評価に適した指標

単色パッチにおける色の見え評価指標（色差式）

CIELAB ΔE (1976) – 最も基本的な色差式で、Lab色空間上のユークリッド距離によって2色間の色差を数値化します。単純な計算で実装しやすく、各成分(L*, a*, b*)の差分も直感的に解釈可能です。しかしCIELAB空間は完全な知覚的均一性を持たないため、特に小さな色差では視覚評価との相関が十分ではないことが報告されています。そのため精度を要する用途では改良版の色差式が使われます。

CIEDE2000 (ΔE₀₀) – CIE（国際照明委員会）がCIELABの不均一性を補正するために勧告した最新の標準色差式です。人間の視覚特性に合わせて色相や彩度方向の重み付けが行われており、小さな色差に対する評価精度が向上しています。印刷物の許容差管理など産業界で広く採用されており、一般用途における事実上の標準指標です。ただしΔE₀₀自体は同一条件下での色差評価を前提としているため、モニタとプリンタのように観察環境が異なる場合には、そのまま適用すると人間の感じる「色の見え」差を捉えきれないことがあります。実用上は、両デバイスの測色値を共通の条件（例: 共通の白色点への色順応）に変換した上でΔE₀₀を計算することで対応可能です。ΔE₀₀の算出アルゴリズム自体は各種ライブラリに実装があり（例えばPythonのcolorioやcolormath等）簡便に利用できます。

CAM16-UCS 色差（色外見モデルに基づく指標） – モニタと印刷物で照明環境や周囲の違いがある場合、カラーアピアランスモデルを用いた色差評価が適しています。CAM16は最新の色外見モデルで、先代のCIECAM02を改良し知覚精度を高めたものです（CIEも2022年にCIECAM02の後継としてCAM16を推奨）。CAM16では観察環境（照明の明るさや媒体の違い）をパラメータとして色の見え（明るさJ、色相h、彩度など）を予測できるため、異なる媒体間でも一貫した色の見えを数値比較できます。具体的には、各デバイス上の色をそれぞれCAM16で知覚属性Jab*（CAM16-UCS空間）に変換し、その距離ΔEを求めます。こうした手法により色印象の一致度を評価でき、異なる観察条件下でも人間の感じる色差を反映した指標となります。（※実装面では、例えばPythonのcolorioライブラリでCAM16-UCS変換がサポートされています）。なお、より高輝度な環境向けにはZCAMやJzAzBz空間といった新しいモデルも提案されていますが、通常の印刷・ディスプレイ範囲の比較ではCAM16ベースで十分対応可能です。


画像全体における視覚的類似性評価指標（画像差評価）

S-CIELAB (Spatial CIELAB) – Zhangらが提案した空間的色差評価手法で、人間視覚の空間周波数特性を考慮して画像の色再現性を評価します。RGB画像を一旦Lab*表色系に近い色Opponent空間に変換し、各チャネルに人間の視覚に基づくぼかしフィルタを適用してからCIELAB色差を計算することで、細部の違い（高周波ノイズやディザパターンなど）で人間に知覚されにくい差異を平滑化します。この空間的フィルタリングによって視覚的に実感される色の違いだけを残すため、大きな一様領域では通常のΔEと同じになりますが、細かなテクスチャ領域では標準のCIELABとは異なる評価となります。実際、S-CIELAB色差はカラー画像の客観評価指標として頻繁に研究に用いられており、主観評価との高い相関も報告されています。出力は画素ごとのΔEマップ（誤差マップ）となり、どの部分で色ズレが大きいか視覚的に確認することも可能です。実装については、論文著者によるMatlabコードが公開されているほか、フィルタ処理とΔE計算を組み合わせれば自作も比較的容易です。

SSIM (構造類似度指数) – 画像全体の見た目の類似度を評価する代表的な指標です。2つの画像の輝度・コントラスト・構造の差異を局所的に比較し、人間が知覚する画質劣化を定量化します。SSIMは画素ごとの絶対誤差ではなく「画像の持つ構造情報」の変化量に着目しており、明るい領域でのマスキング効果やテクスチャのある部分でのコントラストマスキング効果も考慮します。そのため、従来のMSEやPSNRと比べて知覚品質との一致性が高く、圧縮やぼかしによる劣化評価によく用いられています。SSIMの計算結果は位置ごとの類似度マップ（SSIMインデックスマップ）として得られ、平均値をとることで画像全体の類似度指標（0～1の範囲で1が完全一致）を得ます。オープンソース実装も豊富で、OpenCVやscikit-image（compare_ssim関数）などで容易に利用可能です。

FSIM / FSIMc (特徴類似度指数) – 高次特徴に基づく画像評価指標で、より最新のフルリファレンス画質評価法です。人間の視覚が画像内のエッジやコーナーなど重要な特徴に注目することに着目し、局所位相的一致度（Phase Congruency）と勾配の大きさを主要な評価軸としています。基本版FSIMは輝度画像で計算されますが、拡張版のFSIMcでは色相・彩度情報も組み込まれており、カラー画像の品質評価に適用されています。研究では様々な歪みに対してFSIMのスコアが主観評価と非常に高い相関を示すことが報告されており、従来指標（SSIMやS-CIELAB等）より精度が高い場合もあります。出力は局所ごとの類似度マップで、論文中でもFSIMマップを用いた可視化結果が示されています。実装は研究者によりMatlabコードが公開済みであり、近年ではOpenCV向けの実装例も存在します。画質劣化の種類によってはSSIMより鋭敏な検出が可能ですが、計算がやや複雑なため社内検証で利用する際はコードの入手・検証を行うとよいでしょう。


参考実装情報: 上記の指標はいずれも再現性の高い定義がなされており、多くがオープンソースで実装されています。例えば、Pythonのcolorioライブラリには各種色差式（CIE76, CIE94, CIEDE2000, CMC）やCAM16-UCS変換が含まれており手軽に利用可能です。画像差分指標についても、scikit-imageやOpenCVにSSIMが実装されているほか、S-CIELABは文献のように研究コミュニティでコードが共有されています。これらを活用することで、**「色印象の一致度」と「画像の空間的な画質差」**の両面からモニタとプリンタの出力を評価できる環境を構築できるでしょう。



作成日時: 2025-09-09 10:34:45